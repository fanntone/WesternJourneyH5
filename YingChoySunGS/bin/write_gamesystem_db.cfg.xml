<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-configuration SYSTEM 
"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd">

<hibernate-configuration>
	<session-factory>
		<!-- Database connection settings -->
		<property name="hibernate.connection.driver_class">com.mysql.jdbc.Driver</property>
		<!-- <property name="hibernate.connection.url">jdbc:mysql://localhost/account_db</property> -->
		<!-- 讀取資料使用 -->
		<property name="hibernate.connection.url">jdbc:mysql://192.168.2.240/gamesystem:3307</property>
		<property name="hibernate.connection.username">game_server_d</property>
		<property name="hibernate.connection.password">123456</property>
		<!-- SQL dialect -->
		<property name="hibernate.dialect">org.hibernate.dialect.MySQLDialect</property>
		<property name="hibernate.connection.autoReconnect">true</property>
		<property name="hibernate.transaction.auto_close_session">false</property>
		<property name="show_sql">true</property>
		<property name="format_sql">true</property>
		<property name="use_sql_comments">true</property>
		<property name="hibernate.connection.useUnicode">true</property>
		<property name="hibernate.connection.characterEncoding">UTF-8</property>
		<!-- 讀 -->
		<property name="hibernate.jdbc.fetch_size">50</property>
		<!-- 寫 -->
		<property name="hibernate.jdbc.batch_size">30</property>
		<!-- C3P0 連接池設定 Begin 版本自帶 不用下載，直接使用 -->
		<!-- <property name="hibernate.connection.provider_class">org.hibernate.connection.C3P0ConnectionProvider</property> -->
		<!-- 最小連接數 -->
		<property name="hibernate.c3p0.min_size">32</property>
		<!-- 最大連接數 -->
		<property name="hibernate.c3p0.max_size">2048</property>
		<!-- 獲得連接的超時時間,如果超過這個時間,會拋出異常，單位秒 -->
		<!-- wait_timeout的最大值分别是24天/365天(windows/linux) -->
		<!-- 60 * 60 * 24 * 365 = 31536000 -->
		<property name="hibernate.c3p0.timeout">31536000</property>
		<!-- 最大的PreparedStatement的數量 -->
		<property name="hibernate.c3p0.max_statements">2048</property>
		<!-- 每隔120秒檢查連接池裡的空閒連接，單位是秒 -->
		<property name="hibernate.c3p0.idle_test_period">60</property>
		<!-- 每次都驗證連接是否可用 -->
		<property name="hibernate.c3p0.validate">true</property>
		<!-- 當連接池裡面的連接用完的時候，C3P0一下獲取的新的連接數 -->
		<property name="hibernate.c3p0.acquire_increment">8</property>
		<!--兩次連接中間隔時間，單位毫秒。Default: 1000 -->
		<property name="hibernate.c3p0.acquireRetryDelay">1000</property>
		<!-- 每60秒檢查所有連接池中的空閒連接。Default: 0 -->
		<property name="hibernate.c3p0.idleConnectionTestPeriod">120</property> <!-- seconds -->
		<!-- 下面這句很重要下面这句很重要 -->
		<!-- hibernate.c3p0.testConnectionOnCheckout這個屬性，它保證了我們前面說的每次取出連接時會檢查該連接是否被關閉了。 -->
		<!-- 不過這個屬性會對性能有一些損耗，程式能用是第一，之後才是它的性能（又不是不能容忍）。 -->
		<property name="hibernate.c3p0.testConnectionOnCheckout">true</property>
		<!-- 如果設為true那麼在取得連接的同時將校驗連接的有效性 -->
		<property name="hibernate.c3p0.testConnectionOnCheckin">true</property>
		<!-- C3P0 連接池設定 End 版本自帶 不用下載，直接使用 -->
		<!-- 配置二级缓存 <property name="hbm2ddl.auto">create</property> -->
		<!-- Hibernate3 <property name="hibernate.cache.provider_class">org.hibernate.cache.EhCacheProvider</property> -->
		<property name="hibernate.cache.region.factory_class">org.hibernate.cache.ehcache.EhCacheRegionFactory</property>
		<!-- 開啟查詢緩存 -->
		<property name="hibernate.cache.use_query_cache">true</property>
		<!-- Drop and re-create the database schema on startup -->
		<!-- validate 加載hibernate時，驗證創建數據庫表結構 create 每次加載hibernate，重新創建數據庫表結構，這就是導致數據庫表數據丟失的原因。 
			create-drop 加載hibernate時創建，退出是刪除表結構 update 加載hibernate自動更新數據庫結構 -->
		<property name="hibernate.hbm2ddl.auto">update</property>
		<property name="hibernate.cache.use_structured_entries">true</property>
		<property name="hibernate.cache.use_second_level_cache">true</property>
		<property name="hibernate.generate_statistics">true</property>
		<property name="net.sf.ehcache.configurationResourceName">ehcache.xml</property>
		<!-- mapping -->
		<mapping class="com.jinglei.data.hibernate.read.account_data" />
		<mapping class="com.jinglei.data.hibernate.write.SP_Result" />
		<mapping class="com.jinglei.data.hibernate.write.SP_PlayerPointsUpdate" />
	</session-factory>
</hibernate-configuration>